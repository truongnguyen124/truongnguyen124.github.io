<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="calculator">
        <div class="screen">
            <input type="text" class="screen_1" value="" disabled>
            <input type="text" class="screen_2" value="" disabled>
        </div>
        
        <div class="calculator_keys">
            <button class="button btn_grey all-clear" value="ac">AC</button>
            <button class="button btn_grey clear" value="c" >C</button>
            <button class="button btn_grey percentage" value="%">%</button>
            <button class="button btn_orange operator" value="÷">÷</button>

            <button class="button btn_lightgrey digit" value="7">7</button>
            <button class="button btn_lightgrey digit" value="8">8</button>
            <button class="button btn_lightgrey digit" value="9">9</button>
            <button class="button btn_orange operator" value="×">×</button>

            <button class="button btn_lightgrey digit" value="4">4</dibuttonv>
            <button class="button btn_lightgrey digit" value="5">5</button>
            <button class="button btn_lightgrey digit" value="6">6</button>
            <button class="button btn_orange operator" value="-">-</button>

            <button class="button btn_lightgrey digit" value="1">1</button>
            <button class="button btn_lightgrey digit" value="2">2</button>
            <button class="button btn_lightgrey digit" value="3">3</button>
            <button class="button btn_orange operator" value="+">+</button>

            <button class="button btn_0 digit" value="0">0</button>
            <button class="button btn_lightgrey decimal" value=".">.</button>
            <button class="button btn_orange execute" value="=">=</button>
        </div>

    </div>

    <script>
        const calculator = {
            displayMath: '0',
            displayValue: '',
            inputStatus: true,
        }

        function updateMath() {
            if (calculator.inputStatus == false) {
                calculator.displayMath = calculator.displayValue
                updateDisplay()
                calculator.inputStatus = true
            }
        }

        function updateDisplay() {
            const displayMath = document.querySelector('.screen_1')
            const displayValue = document.querySelector('.screen_2')
            displayMath.value = calculator.displayMath
            displayValue.value = calculator.displayValue
        }

        function lastCharIsNum() {
            let str = calculator.displayMath
            let lastChar = str.charAt(str.length-1)
            return Number.isInteger(lastChar)
        }

        function inputDigit(digit){
            if (calculator.displayMath==0) {
                calculator.displayMath = digit
            } else {
                calculator.displayMath += digit
            }
            updateDisplay()
        }

        function inputOperator(operator){
            updateMath()
            calculator.displayMath += operator
            updateDisplay()
        }

        function clear(){
            calculator.displayMath = calculator.displayMath.slice(0, -1)
            updateDisplay()
        }

        function allClear(){
            calculator.displayMath = '0'
            calculator.displayValue = ''
            updateDisplay()
        }

        function mathExecute(){
            let math = calculator.displayMath
            math = math.replace(/÷/g, '/')
            math = math.replace(/×/g, '*')
            let res = eval(math)
            calculator.displayValue = res
            calculator.inputStatus = false
            updateDisplay()
        }

        function percentage(){
            if(!calculator.displayValue==''){
                calculator.displayValue /= 100
            } else {
                mathExecute()
                calculator.displayValue /= 100
            }
            updateDisplay()
        }

        function decimal() {
            if(lastCharIsNum()) {
                calculator.displayValue += '.'
            }
            updateDisplay()
        }

        function buttonHandler(event){
            const target = event.target
            
            if(!target.matches('button')) {
                return
            }

            if(target.classList.contains('operator')){
                console.log('operator', target.value)
                inputOperator(target.value)
                return
            }
            if(target.classList.contains('decimal')){
                console.log('decimal', target.value)
                return
            }
            if(target.classList.contains('digit')){
                console.log('digit', target.value)
                inputDigit(target.value)
                return
            }
            if(target.classList.contains('clear')){
                console.log('clear', target.value)
                clear()
                return
            }
            if(target.classList.contains('all-clear')){
                console.log('all-clear', target.value)
                allClear()
                return
            }
            if(target.classList.contains('execute')){
                console.log('execute', target.value)
                mathExecute()
                return
            }
            if(target.classList.contains('percentage')){
                console.log('percentage', target.value)
                percentage()
                return
            }
        }

        updateDisplay()
        const keys = document.querySelector('.calculator_keys')
        keys.addEventListener('click',(event) => buttonHandler(event))

    </script>
</body>
</html>